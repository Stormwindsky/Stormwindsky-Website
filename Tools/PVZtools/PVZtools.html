<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PVZ Mod Tool</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        h1 {
            color: #4CCF2A;
            text-align: center;
            margin-bottom: 30px;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .drop-zone {
            border: 3px dashed #4CCF2A;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .drop-zone:hover {
            background-color: #f0fff0;
        }
        .drop-zone.highlight {
            background-color: #e0ffe0;
            border-color: #2e8b57;
        }
        .plant-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .plant-section h3 {
            margin-top: 0;
            color: #2e8b57;
            border-bottom: 1px solid #ddd;
            padding-bottom: 5px;
        }
        .attribute-control {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }
        .attribute-control label {
            width: 200px;
            font-weight: bold;
        }
        .attribute-control input {
            flex-grow: 1;
            margin: 0 10px;
        }
        .attribute-control .value-display {
            width: 60px;
            text-align: right;
            font-weight: bold;
            color: #4CCF2A;
        }
        .info-box {
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-size: 14px;
        }
        button {
            background-color: #4CCF2A;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            display: block;
            margin: 20px auto;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3cb022;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .status {
            text-align: center;
            margin-top: 10px;
            font-style: italic;
            color: #666;
        }
        .success {
            color: #4CCF2A;
        }
        .error {
            color: #ff3333;
        }
        .url-container {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f8f8;
            border-radius: 5px;
            word-break: break-all;
        }
        .url-container input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 5px;
        }
        .copy-btn {
            background-color: #4CCF2A;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            margin-top: 5px;
            font-size: 12px;
        }
        .copy-btn:hover {
            background-color: #3cb022;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            overflow-x: auto;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #f1f1f1;
            margin-right: 5px;
            border-radius: 5px 5px 0 0;
            white-space: nowrap;
        }
        .tab.active {
            background-color: #4CCF2A;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .search-box {
            margin-bottom: 15px;
        }
        .search-box input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .credits {
            margin-top: 30px;
            text-align: center;
            font-size: 12px;
            color: #666;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }
        .legal-notice {
            font-size: 11px;
            margin-top: 10px;
            color: #888;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>PVZ Complete Mod Tool</h1>
        
        <div class="drop-zone" id="dropZone">
            <p>Drag and drop PlantsVsZombies.exe here</p>
            <p><small>(or click to select file)</small></p>
            <input type="file" id="fileInput" style="display: none;" accept=".exe">
        </div>
        
        <div id="editorContainer" style="display: none;">
            <div class="search-box">
                <input type="text" id="plantSearch" placeholder="Search plants...">
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="peashooter">Peashooter</div>
                <div class="tab" data-tab="sunflowers">Sunflowers</div>
                <div class="tab" data-tab="defensive">Defensive</div>
                <div class="tab" data-tab="special">Special</div>
                <div class="tab" data-tab="damages">Other Damages</div>
                <div class="tab" data-tab="others">Others</div>
                <div class="tab" data-tab="currency">Currency & Shop</div>
                <div class="tab" data-tab="actions">Plant Actions</div>
                <div class="tab" data-tab="all">All Plants</div>
            </div>
            
            <!-- Peashooter Family -->
            <div class="tab-content active" id="peashooter">
                <!-- ... (previous peashooter content remains the same) ... -->
            </div>
            
            <!-- Sunflower Family -->
            <div class="tab-content" id="sunflowers">
                <!-- ... (previous sunflower content remains the same) ... -->
            </div>
            
            <!-- Defensive Plants -->
            <div class="tab-content" id="defensive">
                <!-- ... (previous defensive content remains the same) ... -->
            </div>
            
            <!-- Special Plants -->
            <div class="tab-content" id="special">
                <!-- ... (previous special content remains the same) ... -->
            </div>
            
            <!-- Other Damages -->
            <div class="tab-content" id="damages">
                <!-- ... (previous damages content remains the same) ... -->
            </div>
            
            <!-- Other Plants -->
            <div class="tab-content" id="others">
                <!-- ... (previous others content remains the same) ... -->
            </div>
            
            <!-- Currency & Shop Tab -->
            <div class="tab-content" id="currency">
                <div class="plant-section" data-name="starting sun">
                    <h3>Starting Sun (1-1)</h3>
                    <div class="attribute-control">
                        <label for="startingSun11">Amount:</label>
                        <input type="range" min="0" max="9999" value="150" class="slider" id="startingSun11" data-offset="0x1B4A91">
                        <span class="value-display" id="startingSun11Value">150</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="starting sun not 1-1">
                    <h3>Starting Sun (Not 1-1)</h3>
                    <div class="attribute-control">
                        <label for="startingSunNot11">Amount:</label>
                        <input type="range" min="0" max="9999" value="50" class="slider" id="startingSunNot11" data-offset="0x1B4A9D">
                        <span class="value-display" id="startingSunNot11Value">50</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="sun value">
                    <h3>Sun Value</h3>
                    <div class="attribute-control">
                        <label for="sunValue">Amount:</label>
                        <input type="range" min="0" max="9999" value="25" class="slider" id="sunValue" data-offset="0x1C5B1A">
                        <span class="value-display" id="sunValueValue">25</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="normal coin value">
                    <h3>Normal Coin Value</h3>
                    <div class="attribute-control">
                        <label for="normalCoinValue">Amount:</label>
                        <input type="range" min="0" max="9999" value="1" class="slider" id="normalCoinValue" data-offset="0xA0051">
                        <span class="value-display" id="normalCoinValueValue">1</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="gatling twin price">
                    <h3>Gatling Pea/Twin Sunflower Price</h3>
                    <div class="attribute-control">
                        <label for="gatlingTwinPrice">Price:</label>
                        <input type="range" min="0" max="9999" value="7500" class="slider" id="gatlingTwinPrice" data-offset="0x241744">
                        <span class="value-display" id="gatlingTwinPriceValue">7500</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="gloom shroom price">
                    <h3>Gloom-Shroom Price</h3>
                    <div class="attribute-control">
                        <label for="gloomShroomPrice">Price:</label>
                        <input type="range" min="0" max="9999" value="750" class="slider" id="gloomShroomPrice" data-offset="0x24177A">
                        <span class="value-display" id="gloomShroomPriceValue">750</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="cattail price">
                    <h3>Cattail Price</h3>
                    <div class="attribute-control">
                        <label for="cattailPrice">Price:</label>
                        <input type="range" min="0" max="9999" value="1000" class="slider" id="cattailPrice" data-offset="0x241780">
                        <span class="value-display" id="cattailPriceValue">1000</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="3k items price">
                    <h3>3K Cost Items Price</h3>
                    <div class="attribute-control">
                        <label for="threeKItemsPrice">Price:</label>
                        <input type="range" min="0" max="9999" value="3000" class="slider" id="threeKItemsPrice" data-offset="0x241786">
                        <span class="value-display" id="threeKItemsPriceValue">3000</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="imitator price">
                    <h3>Imitator Price</h3>
                    <div class="attribute-control">
                        <label for="imitatorPrice">Price:</label>
                        <input type="range" min="0" max="9999" value="30000" class="slider" id="imitatorPrice" data-offset="0x241792">
                        <span class="value-display" id="imitatorPriceValue">30000</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="2.5k items price">
                    <h3>2.5K Cost Items Price</h3>
                    <div class="attribute-control">
                        <label for="twoPointFiveKItemsPrice">Price:</label>
                        <input type="range" min="0" max="9999" value="2500" class="slider" id="twoPointFiveKItemsPrice" data-offset="0x241798">
                        <span class="value-display" id="twoPointFiveKItemsPriceValue">2500</span>
                    </div>
                </div>
            </div>
            
            <!-- Plant Specific Actions Tab -->
            <div class="tab-content" id="actions">
                <div class="plant-section" data-name="potato mine arm timer">
                    <h3>Potato Mine Arm Timer</h3>
                    <div class="attribute-control">
                        <label for="potatoMineArmTimer">Timer (ms):</label>
                        <input type="range" min="0" max="9999" value="15000" class="slider" id="potatoMineArmTimer" data-offset="0x20ABFE">
                        <span class="value-display" id="potatoMineArmTimerValue">15000</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="chomper chew timer">
                    <h3>Chomper Chew Timer</h3>
                    <div class="attribute-control">
                        <label for="chomperChewTimer">Timer (ms):</label>
                        <input type="range" min="0" max="9999" value="4200" class="slider" id="chomperChewTimer" data-offset="0x20DE93">
                        <span class="value-display" id="chomperChewTimerValue">4200</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="chomper bite speed">
                    <h3>Chomper Bite Speed</h3>
                    <div class="attribute-control">
                        <label for="chomperBiteSpeed">Speed (ms):</label>
                        <input type="range" min="0" max="9999" value="3000" class="slider" id="chomperBiteSpeed" data-offset="0x20DCFC">
                        <span class="value-display" id="chomperBiteSpeedValue">3000</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="sunshroom growth timer">
                    <h3>Sunshroom Growth Timer</h3>
                    <div class="attribute-control">
                        <label for="sunshroomGrowthTimer">Timer (ms):</label>
                        <input type="range" min="0" max="9999" value="24000" class="slider" id="sunshroomGrowthTimer" data-offset="0x20ACA1">
                        <span class="value-display" id="sunshroomGrowthTimerValue">24000</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="doom shroom crater timer">
                    <h3>Doom Shroom Crater Timer</h3>
                    <div class="attribute-control">
                        <label for="doomShroomCraterTimer">Timer (ms):</label>
                        <input type="range" min="0" max="9999" value="18000" class="slider" id="doomShroomCraterTimer" data-offset="0x21329D">
                        <span class="value-display" id="doomShroomCraterTimerValue">18000</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="spikeweed attack rate">
                    <h3>Spikeweed Attack Rate</h3>
                    <div class="attribute-control">
                        <label for="spikeweedAttackRate">Rate (ms):</label>
                        <input type="range" min="0" max="9999" value="500" class="slider" id="spikeweedAttackRate" data-offset="0x20B50F">
                        <span class="value-display" id="spikeweedAttackRateValue">500</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="magnet shroom cooldown">
                    <h3>Magnet Shroom Cooldown</h3>
                    <div class="attribute-control">
                        <label for="magnetShroomCooldown">Cooldown (ms):</label>
                        <input type="range" min="0" max="9999" value="3000" class="slider" id="magnetShroomCooldown" data-offset="0x1E6F7C">
                        <span class="value-display" id="magnetShroomCooldownValue">3000</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="chomper range">
                    <h3>Chomper Range</h3>
                    <div class="attribute-control">
                        <label for="chomperRange">Range:</label>
                        <input type="range" min="0" max="9999" value="70" class="slider" id="chomperRange" data-offset="0x214B70">
                        <span class="value-display" id="chomperRangeValue">70</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="fume shroom range">
                    <h3>Fume Shroom Range</h3>
                    <div class="attribute-control">
                        <label for="fumeShroomRange">Range:</label>
                        <input type="range" min="0" max="9999" value="120" class="slider" id="fumeShroomRange" data-offset="0x18196">
                        <span class="value-display" id="fumeShroomRangeValue">120</span>
                    </div>
                </div>
                
                <div class="plant-section" data-name="spikeweed range">
                    <h3>Spikeweed Range</h3>
                    <div class="attribute-control">
                        <label for="spikeweedRange">Range:</label>
                        <input type="range" min="0" max="9999" value="32" class="slider" id="spikeweedRange" data-offset="0x214CD2">
                        <span class="value-display" id="spikeweedRangeValue">32</span>
                    </div>
                </div>
            </div>
            
            <!-- All Plants Tab -->
            <div class="tab-content" id="all">
                <!-- This tab will be populated dynamically with all plants -->
            </div>
            
            <div class="url-container" id="urlContainer">
                <p>Share this configuration:</p>
                <input type="text" id="shareUrl" readonly>
                <button class="copy-btn" id="copyUrlBtn">Copy URL</button>
            </div>
            
            <p class="status" id="status"></p>
        </div>
        
        <button id="saveButton" disabled>Save Changes</button>
        
        <div class="info-box">
            <h3>About this tool:</h3>
            <p>This tool modifies all plant attributes in Plants vs. Zombies by editing the executable file.</p>
            <p>All values are stored in the URL, so you can share your configurations easily.</p>
            <p><strong>Note:</strong> Always make a backup of your original executable before modifying.</p>
        </div>

        <div class="credits">
            <p>Plants vs. Zombies is a registered trademark of Electronic Arts Inc.</p>
            <p>Original game developed by PopCap Games.</p>
            <div class="legal-notice">
                <p>This mod tool is provided for educational purposes only and requires ownership of the original game (English Steam version).</p>
                <p>All rights to Plants vs. Zombies are reserved by Electronic Arts and PopCap Games.</p>
                <p>This tool is not affiliated with or endorsed by Electronic Arts or PopCap Games.</p>
            </div>
        </div>
    </div>

    <script>
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const editorContainer = document.getElementById('editorContainer');
        const saveButton = document.getElementById('saveButton');
        const status = document.getElementById('status');
        const urlContainer = document.getElementById('urlContainer');
        const shareUrl = document.getElementById('shareUrl');
        const copyUrlBtn = document.getElementById('copyUrlBtn');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const plantSearch = document.getElementById('plantSearch');
        const allPlantsTab = document.getElementById('all');
        
        let file = null;
        let fileData = null;
        
        // Initialize all sliders
        const sliders = document.querySelectorAll('.slider');
        const sliderData = {};
        
        // Create the "All Plants" tab by cloning all plant sections
        function initializeAllPlantsTab() {
            const plantSections = document.querySelectorAll('.plant-section');
            plantSections.forEach(section => {
                const clone = section.cloneNode(true);
                allPlantsTab.appendChild(clone);
            });
        }
        
        // Initialize search functionality
        function initializeSearch() {
            plantSearch.addEventListener('input', () => {
                const searchTerm = plantSearch.value.toLowerCase();
                const plantSections = document.querySelectorAll('.plant-section');
                
                plantSections.forEach(section => {
                    const plantName = section.dataset.name.toLowerCase();
                    if (plantName.includes(searchTerm)) {
                        section.style.display = 'block';
                    } else {
                        section.style.display = 'none';
                    }
                });
            });
        }
        
        // Handle drag and drop events
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, preventDefaults, false);
        });
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        ['dragenter', 'dragover'].forEach(eventName => {
            dropZone.addEventListener(eventName, highlight, false);
        });
        
        ['dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, unhighlight, false);
        });
        
        function highlight() {
            dropZone.classList.add('highlight');
        }
        
        function unhighlight() {
            dropZone.classList.remove('highlight');
        }
        
        // Handle file drop
        dropZone.addEventListener('drop', handleDrop, false);
        
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }
        
        // Handle file selection via click
        dropZone.addEventListener('click', () => {
            fileInput.click();
        });
        
        fileInput.addEventListener('change', (e) => {
            handleFiles(e.target.files);
        });
        
        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
            });
        });
        
        // Initialize sliders and their value displays
        sliders.forEach(slider => {
            const valueDisplay = document.getElementById(slider.id + 'Value');
            
            // Store slider data
            sliderData[slider.id] = {
                element: slider,
                valueDisplay: valueDisplay,
                offset: parseInt(slider.dataset.offset, 16),
                defaultValue: parseInt(slider.value)
            };
            
            // Update display when slider changes
            slider.addEventListener('input', () => {
                valueDisplay.textContent = slider.value;
                updateShareUrl();
            });
        });
        
        // Check for URL parameters on page load
        window.addEventListener('DOMContentLoaded', () => {
            initializeAllPlantsTab();
            initializeSearch();
            
            const urlParams = new URLSearchParams(window.location.search);
            
            // Apply URL parameters to sliders
            sliders.forEach(slider => {
                const paramValue = urlParams.get(slider.id);
                if (paramValue && !isNaN(paramValue)) {
                    const value = Math.min(9999, Math.max(0, parseInt(paramValue)));
                    slider.value = value;
                    document.getElementById(slider.id + 'Value').textContent = value;
                }
            });
        });
        
        function handleFiles(files) {
            if (files.length === 0) return;
            
            file = files[0];
            if (!file.name.toLowerCase().endsWith('.exe')) {
                status.textContent = 'Please select an EXE file';
                status.className = 'status error';
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    fileData = new Uint8Array(e.target.result);
                    
                    // Read current values from the file
                    Object.keys(sliderData).forEach(sliderId => {
                        const data = sliderData[sliderId];
                        if (fileData.length > data.offset + 3) {
                            // Read current value (little-endian)
                            const currentValue = fileData[data.offset] | 
                                              (fileData[data.offset + 1] << 8) | 
                                              (fileData[data.offset + 2] << 16) | 
                                              (fileData[data.offset + 3] << 24);
                            
                            // Only update if no URL parameter for this slider
                            const urlParams = new URLSearchParams(window.location.search);
                            if (!urlParams.has(sliderId)) {
                                data.element.value = currentValue;
                                data.valueDisplay.textContent = currentValue;
                            }
                        }
                    });
                    
                    editorContainer.style.display = 'block';
                    saveButton.disabled = false;
                    
                    status.textContent = 'File loaded successfully! Ready to modify.';
                    status.className = 'status success';
                    
                    updateShareUrl();
                } catch (error) {
                    status.textContent = 'Error processing file: ' + error.message;
                    status.className = 'status error';
                    console.error(error);
                }
            };
            
            reader.onerror = function() {
                status.textContent = 'Error reading file';
                status.className = 'status error';
            };
            
            reader.readAsArrayBuffer(file);
        }
        
        // Update the shareable URL
        function updateShareUrl() {
            const currentUrl = new URL(window.location.href);
            currentUrl.search = '';
            
            // Add all slider values to URL
            Object.keys(sliderData).forEach(sliderId => {
                currentUrl.searchParams.set(sliderId, sliderData[sliderId].element.value);
            });
            
            shareUrl.value = currentUrl.toString();
        }
        
        // Copy URL to clipboard
        copyUrlBtn.addEventListener('click', () => {
            shareUrl.select();
            document.execCommand('copy');
            
            const originalText = copyUrlBtn.textContent;
            copyUrlBtn.textContent = 'Copied!';
            setTimeout(() => {
                copyUrlBtn.textContent = originalText;
            }, 2000);
        });
        
        // Handle save button click
        saveButton.addEventListener('click', () => {
            if (!fileData) return;
            
            try {
                // Write all modified values
                Object.keys(sliderData).forEach(sliderId => {
                    const data = sliderData[sliderId];
                    const newValue = parseInt(data.element.value);
                    
                    // Only write if we have space in the file
                    if (fileData.length > data.offset + 3) {
                        // Write new value (little-endian)
                        fileData[data.offset] = newValue & 0xFF;
                        fileData[data.offset + 1] = (newValue >> 8) & 0xFF;
                        fileData[data.offset + 2] = (newValue >> 16) & 0xFF;
                        fileData[data.offset + 3] = (newValue >> 24) & 0xFF;
                    }
                });
                
                // Create download link
                const blob = new Blob([fileData], {type: 'application/octet-stream'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = file.name.replace('.exe', '_modded.exe') || 'PlantsVsZombies_modded.exe';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                status.textContent = 'Modded file saved successfully!';
                status.className = 'status success';
            } catch (error) {
                status.textContent = 'Error saving file: ' + error.message;
                status.className = 'status error';
                console.error(error);
            }
        });
    </script>
</body>
</html>
